/* PV-Überschuss-Steuerung Admin – dunkles Theme, Dashboard-Stil */
:root {
    --scc-bg: #1a1a1e;
    --scc-text: #e0e0e0;
    --scc-heading: #ffffff;
    --scc-muted: #9e9e9e;
    --scc-border: #404040;
    --scc-card-bg: #25252b;
    --scc-source: #f0b429;
    --scc-battery: #e91e63;
    --scc-consumer: #4caf50;
    --scc-consumption: #ff9800;
    --scc-accent: #2196f3;
}

.scc-flow {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    padding: 24px 32px;
    width: 100%;
    max-width: none;
    margin: 0;
    background: var(--scc-bg);
    color: var(--scc-text);
    min-height: 100%;
    box-sizing: border-box;
}
.scc-dash-header {
    display: flex;
    flex-wrap: wrap;
    align-items: center;
    justify-content: space-between;
    gap: 1rem;
    margin-bottom: 1.5rem;
}
.scc-flow h2 { margin: 0; color: var(--scc-heading); font-size: 1.35rem; }
.scc-refresh { margin: 0; display: flex; align-items: center; gap: 0.5rem; flex-wrap: wrap; }
.scc-refresh button {
    padding: 8px 16px;
    background: var(--scc-accent);
    color: #fff;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    font-size: 0.9rem;
}
.scc-refresh button:hover { background: #1976d2; }
.scc-refresh button.scc-btn-icon {
    padding: 8px;
    display: inline-flex;
    align-items: center;
    justify-content: center;
}
.scc-refresh button.scc-btn-icon svg { flex-shrink: 0; }
.scc-status { color: var(--scc-muted); font-size: 0.9rem; margin-left: 0.25rem; }

.scc-dashboard {
    display: grid;
    grid-template-columns: minmax(380px, 520px) minmax(420px, 1fr) 360px;
    gap: 2rem;
    align-items: start;
}
.scc-dash-house {
    position: sticky;
    top: 1rem;
    min-width: 0;
}
.scc-dash-main { min-width: 0; }
.scc-dash-side { min-width: 0; }
.scc-section-house .scc-flow-diagram-wrap {
    margin-top: 0;
    padding: 1rem;
}
.scc-section-house .scc-flow-diagram {
    width: 100%;
}
@media (max-width: 1280px) {
    .scc-dashboard { grid-template-columns: 1fr 360px; }
    .scc-dash-house { grid-column: 1 / -1; position: static; max-width: 600px; margin: 0 auto; }
}
.scc-dash-footer {
    margin-top: 2rem;
    padding-top: 1.5rem;
    border-top: 1px solid var(--scc-border);
    width: 100%;
}
.scc-section-devices {
    margin-top: 0;
}
.scc-section-devices .scc-devices-grid {
    display: flex;
    flex-direction: row;
    flex-wrap: wrap;
    gap: 1rem;
    justify-content: flex-start;
}
@media (max-width: 700px) {
    .scc-flow { padding: 16px 20px; }
    .scc-dashboard { grid-template-columns: 1fr; gap: 1.5rem; }
    .scc-dash-house { max-width: none; }
    .scc-dash-footer { margin-top: 1.5rem; padding-top: 1rem; }
    .scc-section-devices .scc-devices-grid { flex-direction: column; }
}

.scc-section {
    background: var(--scc-card-bg);
    border: 1px solid var(--scc-border);
    border-radius: 12px;
    padding: 1.5rem;
}
.scc-section h3 {
    margin: 0 0 1rem 0;
    font-size: 1rem;
    font-weight: 600;
    color: var(--scc-muted);
    text-transform: uppercase;
    letter-spacing: 0.04em;
}

/* Autarkie groß */
.scc-section-autarky {
    margin-bottom: 1rem;
}
.scc-autarky-block {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 1.25rem;
    background: linear-gradient(135deg, rgba(76, 175, 80, 0.15) 0%, rgba(33, 150, 243, 0.08) 100%);
    border: 2px solid var(--scc-consumer);
    border-radius: 16px;
}
.scc-autarky-value {
    font-size: 3.5rem;
    font-weight: 800;
    line-height: 1;
    color: var(--scc-consumer);
    font-variant-numeric: tabular-nums;
}
.scc-autarky-unit {
    font-size: 1.5rem;
    font-weight: 700;
    color: var(--scc-consumer);
    margin-left: 2px;
}
.scc-autarky-label {
    font-size: 0.85rem;
    color: var(--scc-muted);
    text-transform: uppercase;
    letter-spacing: 0.05em;
    margin-top: 0.35rem;
}
.scc-autarky-block.scc-autarky-full {
    box-shadow: 0 0 0 1px rgba(76, 175, 80, 0.4), 0 0 24px rgba(76, 175, 80, 0.15);
    animation: sccAutarkyPulse 2.5s ease-in-out infinite;
}
@keyframes sccAutarkyPulse {
    0%, 100% { box-shadow: 0 0 0 1px rgba(76, 175, 80, 0.4), 0 0 24px rgba(76, 175, 80, 0.15); }
    50% { box-shadow: 0 0 0 1px rgba(76, 175, 80, 0.5), 0 0 32px rgba(76, 175, 80, 0.22); }
}

/* Erster Datenabruf: sanfter Fade-in der Sektionen */
.scc-has-data .scc-section {
    animation: sccFadeIn 0.5s ease-out;
}
@keyframes sccFadeIn {
    from { opacity: 0; transform: translateY(6px); }
    to { opacity: 1; transform: translateY(0); }
}

/* PV-Vorhersage */
.scc-forecast-line {
    margin: 0;
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: 0.75rem;
}
.scc-forecast-label { color: var(--scc-muted); font-size: 0.9rem; }
.scc-forecast-value { font-weight: 700; color: var(--scc-source); }

/* Energiefluss: Knoten in einer Reihe mit Pfeilen */
.scc-diagram { margin: 0; }
.scc-flow-row {
    display: flex;
    flex-wrap: wrap;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
    min-height: 120px;
}
.scc-node {
    padding: 1.25rem 1.5rem;
    border-radius: 12px;
    min-width: 150px;
    text-align: center;
    border: 2px solid var(--scc-border);
    background: var(--scc-card-bg);
    color: var(--scc-text);
    transition: border-color 0.2s, box-shadow 0.2s;
}
.scc-node-icon { font-size: 1.75rem; margin-bottom: 0.35rem; line-height: 1; }
.scc-node-label { font-size: 0.8rem; color: var(--scc-muted); text-transform: uppercase; letter-spacing: 0.03em; }
.scc-node-value { font-size: 1.2rem; font-weight: 700; color: var(--scc-heading); margin-top: 0.25rem; }
.scc-node-sublabel { font-size: 0.75rem; color: var(--scc-muted); margin-top: 0.2rem; }

.scc-node-source { border-color: var(--scc-source); background: rgba(240, 180, 41, 0.12); }
.scc-node-battery { border-color: var(--scc-border); background: rgba(233, 30, 99, 0.08); }
.scc-node-battery.active { border-color: var(--scc-battery); background: rgba(233, 30, 99, 0.18); }
.scc-node-consumer { border-color: var(--scc-consumer); background: rgba(76, 175, 80, 0.12); }

.scc-flow-arrow {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    min-width: 64px;
    padding: 0 8px;
    color: var(--scc-muted);
}
.scc-flow-arrow-line {
    display: block;
    width: 24px;
    height: 2px;
    background: var(--scc-muted);
    margin-bottom: 2px;
}
.scc-flow-arrow-label {
    font-size: 0.75rem;
    color: var(--scc-muted);
    font-weight: 600;
}
.scc-flow-arrow::before {
    content: '→';
    font-size: 1.1rem;
    margin-bottom: 2px;
}

/* Übersicht Tabelle */
.scc-sources-table {
    width: 100%;
    border-collapse: collapse;
    font-size: 0.95rem;
}
.scc-sources-table td { padding: 0.6rem 0; border-bottom: 1px solid var(--scc-border); font-size: 0.95rem; }
.scc-sources-table tr:last-child td { border-bottom: none; }
.scc-sources-name { color: var(--scc-text); }
.scc-sources-value { text-align: right; font-weight: 600; color: var(--scc-heading); }
.scc-sources-dot {
    display: inline-block;
    width: 10px;
    height: 10px;
    border-radius: 50%;
    margin-right: 8px;
    vertical-align: middle;
}
.scc-dot-source { background: var(--scc-source); }
.scc-dot-battery { background: var(--scc-battery); }
.scc-dot-consumer { background: var(--scc-consumer); }
.scc-dot-consumption { background: var(--scc-consumption); }

.scc-flow-consumption {
    margin-top: 1rem;
    padding: 0.75rem 1rem;
    border-radius: 10px;
    border: 1px solid var(--scc-consumption);
    background: rgba(255, 152, 0, 0.1);
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 1rem;
}
.scc-flow-consumption-label { font-size: 0.85rem; color: var(--scc-muted); }
.scc-flow-consumption-value { font-size: 1.1rem; font-weight: 700; color: var(--scc-consumption); }

/* Grafische Energiefluss-Ansicht (Haus, PV, Batterie, Netz) */
.scc-flow-diagram-wrap {
    margin-top: 1.25rem;
    padding: 1.25rem;
    background: linear-gradient(180deg, rgba(0,0,0,0.25) 0%, rgba(0,0,0,0.12) 100%);
    border-radius: 14px;
    border: 1px solid var(--scc-border);
}
.scc-flow-diagram {
    max-width: 100%;
    overflow: hidden;
}
.scc-flow-svg {
    display: block;
    width: 100%;
    max-width: 480px;
    height: auto;
    margin: 0 auto;
}
/* Linien: inaktiv grau, aktiv je nach Typ farbig */
.scc-flow-svg .scc-flow-line {
    stroke: var(--scc-border);
    stroke-width: 4;
    stroke-linecap: round;
    transition: stroke 0.35s ease, stroke-width 0.35s ease;
}
.scc-flow-svg .scc-flow-line--pv.scc-flow-line--active { stroke: var(--scc-source); stroke-width: 5; }
.scc-flow-svg .scc-flow-line--battery.scc-flow-line--active { stroke: var(--scc-battery); stroke-width: 5; }
.scc-flow-svg .scc-flow-line--grid.scc-flow-line--active { stroke: var(--scc-accent); stroke-width: 5; }
/* Knoten: einheitlich größer, klare Ränder */
.scc-flow-svg .scc-flow-node-bg {
    fill: var(--scc-card-bg);
    stroke-width: 2.5;
    transition: fill 0.2s ease, stroke 0.2s ease;
}
.scc-flow-svg .scc-flow-node-hub-bg {
    fill: rgba(76, 175, 80, 0.12);
    stroke: var(--scc-consumer);
}
.scc-flow-svg .scc-flow-node-pv .scc-flow-node-bg { stroke: var(--scc-source); }
.scc-flow-svg .scc-flow-node-battery .scc-flow-node-bg { stroke: var(--scc-battery); }
.scc-flow-svg .scc-flow-node-grid .scc-flow-node-bg { stroke: var(--scc-accent); }
/* SVG-Icons in Knoten */
.scc-flow-svg .scc-flow-icon-path {
    fill: currentColor;
    stroke: currentColor;
    color: inherit;
}
.scc-flow-svg .scc-flow-node-pv .scc-flow-icon-path { color: var(--scc-source); }
.scc-flow-svg .scc-flow-node-hub .scc-flow-icon-path { color: var(--scc-consumer); }
.scc-flow-svg .scc-flow-node-battery .scc-flow-icon-path { color: var(--scc-battery); }
.scc-flow-svg .scc-flow-node-grid .scc-flow-icon-path { color: var(--scc-accent); }
/* Text in Knoten */
.scc-flow-svg .scc-flow-node text {
    fill: var(--scc-text);
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    font-size: 12px;
}
.scc-flow-svg .scc-flow-node-value {
    font-size: 13px;
    font-weight: 700;
    fill: var(--scc-heading);
}
.scc-flow-svg .scc-flow-node-label {
    font-size: 10px;
    fill: var(--scc-muted);
    text-transform: uppercase;
    letter-spacing: 0.04em;
}

/* Haus-Grafik mit Overlay (Verbindungen + Werte) – füllt die linke Spalte */
.scc-house-wrap {
    position: relative;
    width: 100%;
    max-width: 100%;
    margin: 0;
    aspect-ratio: 1024 / 1536;
    background-color: rgba(0, 0, 0, 0.4);
    border-radius: 12px;
    overflow: hidden;
}
.scc-house-img {
    position: absolute;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    object-fit: contain;
    object-position: center;
}
.scc-house-svg {
    position: absolute;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
}
.scc-house-lines .scc-house-line-base {
    stroke: rgba(0, 0, 0, 0.85);
    stroke-width: 5;
    stroke-linecap: round;
}
.scc-house-lines .scc-house-line {
    stroke-width: 6;
    stroke-linecap: round;
    stroke: rgba(0,0,0,0);
    transition: stroke-width 0.25s ease;
}
.scc-house-lines .scc-house-line--active { stroke-width: 7; filter: url(#scc-flow-glow-abs); }
.scc-house-lines .scc-house-line--active.scc-house-line--green { stroke: url(#scc-green-flow); }
.scc-house-lines .scc-house-line--active.scc-house-line--red { stroke: url(#scc-red-flow); }
.scc-house-lines .scc-house-line--active.scc-house-line--mixed { stroke: url(#scc-mixed-flow); }
/* Wallbox/Wärmepumpe: Vollton-Stroke */
/* Comet-Stroke wird per JS (url(#scc-comet-…)) gesetzt; Wallbox/Wärmepumpe nutzen dieselben Gradiente */

/* Animierte Flusslinien mit Kometen-Effekt (Gradient entlang Pfad: vorne hell → hinten transparent) */
.scc-house-lines .scc-house-line--active {
    stroke-dasharray: 5 25; /* Periode 30 */
    animation-duration: 0.9s;
    animation-timing-function: linear;
    animation-iteration-count: infinite;
}
.scc-house-lines .scc-house-line--active.scc-house-line--dir-fwd { animation-name: sccFlowDashFwd; }
.scc-house-lines .scc-house-line--active.scc-house-line--dir-rev { animation-name: sccFlowDashRev; }
/* Gestrichelte Linien (Wallbox/Wärmepumpe) */
.scc-house-lines .scc-house-line--dashed.scc-house-line--active.scc-house-line--dir-fwd { animation-name: sccFlowDashFwd; stroke-dasharray: 5 25; }
.scc-house-lines .scc-house-line--dashed.scc-house-line--active.scc-house-line--dir-rev { animation-name: sccFlowDashRev; stroke-dasharray: 5 25; }

@keyframes sccFlowDashFwd {
    from { stroke-dashoffset: 0; }
    to { stroke-dashoffset: -30; }
}
@keyframes sccFlowDashRev {
    from { stroke-dashoffset: 0; }
    to { stroke-dashoffset: 30; }
}
/* Netzpfad Ende (918,950) leicht durchsichtig */
.scc-house-lines .scc-house-line-base--grid-end { stroke-opacity: 0.45; }
.scc-house-lines .scc-house-line--grid-end.scc-house-line--active { stroke-opacity: 0.65; }
/* Wallbox / Wärmepumpe: Grundlinie gestrichelt (inaktiv), aktiv = Komet-Muster (oben definiert) */
.scc-house-lines .scc-house-line--dashed { stroke-dasharray: 5 8; }
.scc-house-dot {
    fill: var(--scc-card-bg);
    stroke: var(--scc-text);
    stroke-width: 2;
}
/* Verbindungslinien Karte → Bauteil (senkrecht, dezent) */
.scc-house-connectors .scc-house-conn {
    fill: none;
    stroke: rgba(255, 255, 255, 0.35);
    stroke-width: 1.8;
    stroke-dasharray: 6 10;
    stroke-linecap: round;
    transition: stroke 0.2s ease;
}
.scc-house-connectors .scc-house-conn:hover {
    stroke: rgba(255, 255, 255, 0.5);
}
/* Dynamische Batterie-Segmente im Hausbild (Koordinaten 645,998 701,979 701,906 645,923) */
.scc-house-battery-display .scc-battery-seg {
    transition: fill 0.35s ease;
}
.scc-house-battery-display .scc-battery-seg--charging {
    animation: scc-battery-pulse 1.2s ease-in-out infinite;
}
@keyframes scc-battery-pulse {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.55; }
}

.scc-house-labels .scc-house-label-block { pointer-events: none; }
.scc-house-label-top .scc-house-value { fill: var(--scc-heading); }
.scc-house-label-top .scc-house-label { fill: var(--scc-muted); }
.scc-house-label-bottom .scc-house-value { fill: var(--scc-heading); }
.scc-house-label-bottom .scc-house-label { fill: var(--scc-muted); }
.scc-house-label-bottom .scc-house-sublabel { fill: var(--scc-muted); }
/* Werte/Zustände: gleiche Logik wie Linien – grün/rot */
.scc-house-value--green { fill: #5aff78 !important; }
.scc-house-value--red { fill: #ff6b6b !important; }
.scc-house-value--mixed { fill: #81c784; }
.scc-house-value--muted { fill: var(--scc-muted) !important; }
.scc-house-sublabel.scc-house-value--green { fill: #5aff78 !important; }
.scc-house-sublabel.scc-house-value--red { fill: #ff6b6b !important; }
.scc-house-sublabel.scc-house-value--muted { fill: var(--scc-muted) !important; }
.scc-house-label.scc-house-value--green { fill: rgba(90, 255, 120, 0.9) !important; }
.scc-house-label.scc-house-value--red { fill: rgba(255, 107, 107, 0.9) !important; }
.scc-house-label.scc-house-value--muted { fill: var(--scc-muted) !important; }
.scc-house-value {
    font-size: 42px;
    font-weight: 700;
    fill: var(--scc-heading);
    font-family: inherit;
    paint-order: stroke;
    stroke: rgba(0, 0, 0, 0.8);
    stroke-width: 5px;
    letter-spacing: 0.02em;
}
.scc-house-label {
    font-size: 20px;
    fill: var(--scc-muted);
    font-family: inherit;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    paint-order: stroke;
    stroke: rgba(0, 0, 0, 0.65);
    stroke-width: 3px;
}
.scc-house-sublabel {
    font-size: 18px;
    fill: var(--scc-muted);
    font-family: inherit;
    text-transform: uppercase;
    letter-spacing: 0.04em;
    paint-order: stroke;
    stroke: rgba(0, 0, 0, 0.55);
    stroke-width: 2.5px;
}

.scc-section-named { margin-top: 1rem; }
.scc-named-list { list-style: none; margin: 0; padding: 0; font-size: 0.95rem; }
.scc-named-list li { display: flex; justify-content: space-between; align-items: center; padding: 0.5rem 0; border-bottom: 1px solid var(--scc-border); }
.scc-named-list li:last-child { border-bottom: none; }
.scc-named-label { color: var(--scc-text); overflow: hidden; text-overflow: ellipsis; white-space: nowrap; max-width: 68%; }
.scc-named-value { font-weight: 600; color: var(--scc-heading); }
.scc-named-value.scc-named-state.on { color: var(--scc-consumer); }
.scc-named-value.scc-named-state.off { color: var(--scc-muted); }
.scc-battery-status { font-weight: 500; font-size: 0.85em; }
.scc-battery-status.scc-status-loading { color: var(--scc-battery); }
.scc-battery-status.scc-status-full { color: var(--scc-consumer); }
.scc-battery-status.scc-status-waiting { color: var(--scc-muted); }

/* Simulation-Banner (Header) */
.scc-simulation-banner {
    margin: 0 0 0.5rem 0;
    padding: 0.4rem 0.75rem;
    font-size: 0.85rem;
    font-weight: 600;
    color: #ffb74d;
    background: rgba(255, 152, 0, 0.15);
    border: 1px solid rgba(255, 152, 0, 0.4);
    border-radius: 8px;
    display: inline-block;
}
.scc-pid-sim-btn {
    margin-left: 0.75rem;
    vertical-align: middle;
}
.scc-pid-sim-box { max-width: 560px; }
.scc-pid-sim-slider-wrap {
    margin-bottom: 1rem;
    padding: 0.75rem 0;
    border-bottom: 1px solid var(--scc-border);
}
.scc-pid-sim-slider-label {
    display: block;
    font-weight: 600;
    font-size: 0.9rem;
    color: var(--scc-heading);
    margin-bottom: 0.35rem;
}
.scc-pid-sim-slider-row {
    display: flex;
    align-items: center;
    gap: 0.75rem;
}
.scc-pid-sim-slider {
    flex: 1;
    min-width: 0;
    height: 8px;
    -webkit-appearance: none;
    appearance: none;
    background: var(--scc-border);
    border-radius: 4px;
}
.scc-pid-sim-slider::-webkit-slider-thumb {
    -webkit-appearance: none;
    appearance: none;
    width: 18px;
    height: 18px;
    border-radius: 50%;
    background: var(--scc-accent);
    cursor: pointer;
}
.scc-pid-sim-slider::-moz-range-thumb {
    width: 18px;
    height: 18px;
    border-radius: 50%;
    background: var(--scc-accent);
    cursor: pointer;
    border: none;
}
.scc-pid-sim-slider-value {
    font-weight: 700;
    min-width: 4rem;
    text-align: right;
    color: var(--scc-heading);
}
.scc-pid-sim-slider-hint {
    margin: 0.35rem 0 0 0;
    font-size: 0.8rem;
    color: var(--scc-muted);
}
.scc-pid-sim-slider-hint code { font-size: 0.85em; }
.scc-pid-sim-howto {
    background: rgba(33, 150, 243, 0.08);
    border: 1px solid rgba(33, 150, 243, 0.25);
    border-radius: 8px;
    padding: 0.75rem 1rem;
    margin-bottom: 1rem;
}
.scc-pid-sim-howto-title {
    margin: 0 0 0.5rem 0;
    font-size: 0.95rem;
    color: var(--scc-heading);
}
.scc-pid-sim-howto-list {
    margin: 0 0 0.5rem 0;
    padding-left: 1.25rem;
    font-size: 0.88rem;
    line-height: 1.5;
    color: var(--scc-text);
}
.scc-pid-sim-howto-list li { margin-bottom: 0.35rem; }
.scc-pid-sim-howto-summary {
    margin: 0;
    font-size: 0.85rem;
    color: var(--scc-muted);
    font-style: italic;
}
.scc-pid-sim-content { margin-top: 0.5rem; }
.scc-pid-sim-card {
    background: var(--scc-bg-subtle, rgba(0,0,0,0.08));
    border-radius: 8px;
    padding: 0.75rem 1rem;
    margin-bottom: 0.75rem;
}
.scc-pid-sim-card-title {
    margin: 0 0 0.5rem 0;
    font-size: 1rem;
    color: var(--scc-heading);
}
.scc-pid-sim-table {
    width: 100%;
    border-collapse: collapse;
    font-size: 0.9rem;
}
.scc-pid-sim-table td { padding: 0.25rem 0.5rem 0.25rem 0; }
.scc-pid-sim-table td:first-child { color: var(--scc-muted); width: 45%; }
.scc-pid-sim-reason {
    margin: 0.5rem 0 0 0;
    font-size: 0.85rem;
    color: var(--scc-muted);
}

/* Geräte: Karten mit EIN/AUS-Symbol und Glow */
.scc-devices-grid {
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
    margin-top: 0.5rem;
}
.scc-device-card {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    padding: 0.75rem 1rem;
    border-radius: 12px;
    border: 2px solid var(--scc-border);
    background: var(--scc-card-bg);
    transition: border-color 0.25s ease, box-shadow 0.25s ease, background 0.25s ease;
}
.scc-device-card--off {
    opacity: 0.85;
}
.scc-device-card--on {
    border-color: rgba(76, 175, 80, 0.5);
    background: rgba(76, 175, 80, 0.08);
    box-shadow: 0 0 0 1px rgba(76, 175, 80, 0.2);
}
.scc-device-icon-wrap {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 44px;
    height: 44px;
    border-radius: 50%;
    flex-shrink: 0;
    background: rgba(255, 255, 255, 0.06);
    transition: box-shadow 0.3s ease, background 0.3s ease;
}
.scc-device-card--off .scc-device-icon-wrap {
    color: var(--scc-muted);
}
.scc-device-card--on .scc-device-icon-wrap {
    color: var(--scc-consumer);
    background: rgba(76, 175, 80, 0.2);
    box-shadow: 0 0 16px rgba(76, 175, 80, 0.4), 0 0 32px rgba(76, 175, 80, 0.2);
}
.scc-device-icon {
    width: 24px;
    height: 24px;
}
.scc-device-label {
    flex: 1;
    font-weight: 600;
    color: var(--scc-text);
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
}
.scc-device-state {
    font-size: 0.8rem;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.04em;
}
.scc-device-card--off .scc-device-state { color: var(--scc-muted); }
.scc-device-card--on .scc-device-state { color: var(--scc-consumer); }

/* PID-Karte: Sensor-Stil mit Name, Wert in %, Verlaufslinie – breiter */
.scc-device-card-pid {
    display: flex;
    flex-direction: column;
    align-items: stretch;
    gap: 0;
    padding: 0.75rem 1rem;
    min-height: 80px;
    min-width: 320px;
    max-width: 420px;
}
.scc-pid-card-temp {
    font-size: 0.85rem;
    color: var(--scc-muted);
    margin-bottom: 0.35rem;
}
.scc-pid-card-top {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    margin-bottom: 0.5rem;
}
.scc-pid-card-head {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    min-width: 0;
}
.scc-pid-card-icon-wrap {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
    color: var(--scc-accent);
}
.scc-device-card-pid .scc-pid-card-icon,
.scc-device-card-pid .scc-device-icon.scc-pid-card-icon {
    width: 20px;
    height: 20px;
}
.scc-pid-card-label {
    font-weight: 600;
    color: var(--scc-text);
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
}
.scc-pid-card-value-wrap {
    text-align: right;
    flex-shrink: 0;
}
.scc-pid-card-value {
    display: block;
    font-weight: 700;
    font-size: 1.5rem;
    line-height: 1.2;
    color: var(--scc-heading);
}
.scc-device-card-pid.scc-device-card--on .scc-pid-card-value { color: var(--scc-consumer); }
.scc-pid-card-unit {
    font-size: 0.8rem;
    color: var(--scc-muted);
}
.scc-pid-card-spark {
    margin-top: auto;
    border-radius: 6px;
    overflow: hidden;
}
.scc-pid-card-spark svg {
    display: block;
    vertical-align: top;
}

.scc-devices-sim-hint {
    margin: 0.75rem 0 0 0;
    font-size: 0.8rem;
    color: var(--scc-muted);
    font-style: italic;
}
.scc-battery-status.scc-status-discharging { color: var(--scc-consumption); }
.scc-muted-small { font-size: 0.85rem; color: var(--scc-muted); margin: 0; }

.scc-msg { margin: 0 0 0.75rem 0; }
.scc-msg-error { color: #f44336; }
.scc-hint { font-size: 0.9em; color: var(--scc-muted); margin: 0 0 0.5rem 0; }
.scc-link { font-size: 0.9em; color: var(--scc-accent); }

/* EVCC-ähnliche Leistungsverteilung (Balken In/Out) */
.scc-section-evcc { margin-top: 1rem; }
.scc-evcc-viz { display: flex; flex-direction: column; gap: 12px; }
.scc-evcc-scale {
    display: flex;
    align-items: center;
    gap: 10px;
    margin: 6px 0;
}
.scc-evcc-bars {
    display: flex;
    align-items: center;
    justify-content: flex-start;
    gap: 6px;
    flex: 1;
    min-width: 0;
    height: 32px;
    background: rgba(255,255,255,0.05);
    border-radius: 8px;
    padding: 4px;
    overflow: hidden;
}
.scc-evcc-bar {
    display: flex;
    align-items: center;
    justify-content: center;
    height: 100%;
    min-width: 24px;
    border-radius: 6px;
    transition: flex-basis 0.45s ease-out;
}
.scc-evcc-bar--hidden { opacity: 0.4; min-width: 0; overflow: hidden; }
.scc-evcc-bar[data-key="pv"] { background: rgba(47, 191, 113, 0.5); color: #bfe3c5; }
.scc-evcc-bar[data-key="grid"] { background: rgba(100, 120, 160, 0.5); color: #b0b8d0; }
.scc-evcc-bar[data-key="feedIn"] { background: rgba(100, 120, 160, 0.4); color: #b0b8d0; }
.scc-evcc-bar[data-key="batteryIn"],
.scc-evcc-bar[data-key="batteryOut"] { background: rgba(233, 30, 99, 0.35); color: #f48fb1; }
.scc-evcc-bar[data-key="consumption"],
.scc-evcc-bar[data-key="home"] { background: rgba(76, 175, 80, 0.4); color: #a5d6a7; }
.scc-evcc-bar.scc-evcc-cons-0 { background: rgba(255, 152, 0, 0.55); color: #ffe0b2; }
.scc-evcc-bar.scc-evcc-cons-1 { background: rgba(0, 150, 136, 0.55); color: #b2dfdb; }
.scc-evcc-bar.scc-evcc-cons-2 { background: rgba(63, 81, 181, 0.55); color: #c5cae9; }
.scc-evcc-bar.scc-evcc-cons-3 { background: rgba(156, 39, 176, 0.5); color: #e1bee7; }
.scc-evcc-bar.scc-evcc-cons-4 { background: rgba(233, 30, 99, 0.4); color: #f8bbd9; }
.scc-evcc-bar.scc-evcc-cons-sonstige { background: rgba(97, 97, 97, 0.5); color: #bdbdbd; }
.scc-evcc-bar-icon { width: 24px; height: 24px; display: flex; align-items: center; justify-content: center; }
.scc-evcc-bar-icon svg { width: 20px; height: 20px; }
.scc-evcc-total { min-width: 72px; text-align: right; font-variant-numeric: tabular-nums; font-weight: 600; color: var(--scc-heading); font-size: 0.9rem; }
.scc-evcc-name { width: 28px; text-align: right; font-size: 0.85rem; color: var(--scc-muted); }

.scc-flow-box {
    border: 1px solid var(--scc-border);
    border-radius: 8px;
    padding: 12px 16px;
    margin: 8px 0;
    background: var(--scc-card-bg);
}
.scc-flow-box.active { background: rgba(76, 175, 80, 0.2); border-color: #4caf50; }
.scc-flow-box.reserved { background: rgba(255, 152, 0, 0.2); border-color: #ff9800; }
.scc-flow-value { font-weight: bold; font-size: 1.1em; }
.scc-flow-value.unit { color: var(--scc-muted); font-weight: normal; }

/* Modal Regeln */
.scc-modal {
    position: fixed;
    inset: 0;
    z-index: 10000;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 1rem;
    visibility: hidden;
    opacity: 0;
    transition: visibility 0.2s, opacity 0.2s;
}
.scc-modal.scc-modal--open {
    visibility: visible;
    opacity: 1;
}
.scc-modal-backdrop {
    position: absolute;
    inset: 0;
    background: rgba(0, 0, 0, 0.6);
    cursor: pointer;
}
.scc-modal-box {
    position: relative;
    width: 100%;
    max-width: 560px;
    max-height: 85vh;
    overflow: hidden;
    display: flex;
    flex-direction: column;
    background: var(--scc-card-bg);
    border: 1px solid var(--scc-border);
    border-radius: 12px;
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
}
.scc-modal-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 1rem 1.25rem;
    border-bottom: 1px solid var(--scc-border);
    flex-shrink: 0;
}
.scc-modal-header h2 { margin: 0; font-size: 1.2rem; color: var(--scc-heading); }
.scc-modal-close {
    width: 36px;
    height: 36px;
    padding: 0;
    border: none;
    background: transparent;
    color: var(--scc-text);
    font-size: 1.5rem;
    line-height: 1;
    cursor: pointer;
    border-radius: 6px;
}
.scc-modal-close:hover { background: var(--scc-border); color: var(--scc-heading); }
.scc-modal-body {
    padding: 1rem 1.25rem;
    overflow-y: auto;
    flex: 1;
    min-height: 0;
}
.scc-modal-hint {
    margin: 0 0 1rem;
    font-size: 0.9rem;
    color: var(--scc-muted);
}
.scc-rules-section { margin-bottom: 1.5rem; }
.scc-rules-section:last-child { margin-bottom: 0; }
.scc-rules-section h3 { margin: 0 0 0.5rem; font-size: 1rem; color: var(--scc-heading); }
.scc-rules-list { list-style: none; margin: 0; padding: 0; }
.scc-rule-card {
    padding: 0.6rem 0.75rem;
    margin-bottom: 0.4rem;
    background: var(--scc-bg);
    border: 1px solid var(--scc-border);
    border-radius: 8px;
    display: flex;
    flex-wrap: wrap;
    align-items: baseline;
    gap: 0.5rem;
}
.scc-rule-name { font-weight: 600; color: var(--scc-heading); }
.scc-muted { color: var(--scc-muted); font-size: 0.9rem; }

.scc-rules-section-head {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 0.75rem;
    margin-bottom: 0.5rem;
}
.scc-rules-section-head h3 { margin: 0; }
.scc-rule-card {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 0.75rem;
    flex-wrap: wrap;
}
.scc-rule-card-main { flex: 1; min-width: 0; }
.scc-rule-card-actions {
    display: flex;
    gap: 0.5rem;
    flex-shrink: 0;
}
.scc-btn { padding: 0.4rem 0.75rem; border-radius: 6px; border: 1px solid var(--scc-border); background: var(--scc-card-bg); color: var(--scc-text); cursor: pointer; font-size: 0.9rem; }
.scc-btn:hover { background: var(--scc-border); }
.scc-btn-sm { padding: 0.25rem 0.5rem; font-size: 0.85rem; }
.scc-btn-primary { background: var(--scc-accent); border-color: var(--scc-accent); color: #fff; }
.scc-btn-primary:hover { background: #1976d2; border-color: #1976d2; }
.scc-btn-secondary { background: transparent; }
.scc-btn-link { background: none; border: none; color: var(--scc-accent); cursor: pointer; padding: 0.2rem 0.4rem; font-size: 0.85rem; text-decoration: underline; }
.scc-btn-link:hover { color: #64b5f6; }
.scc-btn-link-danger { color: #f44336; }
.scc-btn-link-danger:hover { color: #e57373; }

.scc-rules-form-wrap {
    margin-bottom: 1.25rem;
    padding: 1rem;
    background: var(--scc-bg);
    border: 1px solid var(--scc-border);
    border-radius: 10px;
}
.scc-rules-form-panel h4 { margin: 0 0 0.75rem; font-size: 1rem; color: var(--scc-heading); }
.scc-pid-help {
    margin-bottom: 1rem;
    padding: 0.75rem 1rem;
    background: var(--scc-bg-subtle, rgba(0,0,0,0.06));
    border-radius: 6px;
    font-size: 0.9rem;
    line-height: 1.45;
    color: var(--scc-text, #333);
}
.scc-pid-help p { margin: 0 0 0.5rem; }
.scc-pid-help p:last-child { margin-bottom: 0; }
.scc-pid-help strong { color: var(--scc-heading, #111); }
.scc-form-grid {
    display: grid;
    grid-template-columns: auto 1fr;
    gap: 0.5rem 1rem;
    align-items: center;
    margin-bottom: 1rem;
}
.scc-form-grid label { color: var(--scc-muted); font-size: 0.9rem; }
.scc-form-grid .scc-checkbox-label { grid-column: span 2; display: flex; align-items: center; gap: 0.5rem; }
.scc-input {
    padding: 0.4rem 0.5rem;
    border: 1px solid var(--scc-border);
    border-radius: 6px;
    background: var(--scc-card-bg);
    color: var(--scc-text);
    font-size: 0.9rem;
    min-width: 0;
}
.scc-input:focus { outline: none; border-color: var(--scc-accent); }
.scc-form-actions { display: flex; gap: 0.5rem; margin-top: 0.75rem; }

.scc-input-with-picker { display: flex; gap: 0.25rem; align-items: center; min-width: 0; }
.scc-input-with-picker .scc-input { flex: 1; min-width: 0; }
.scc-picker-btn {
    flex-shrink: 0;
    width: 32px;
    height: 32px;
    padding: 0;
    border: 1px solid var(--scc-border);
    border-radius: 6px;
    background: var(--scc-card-bg);
    color: var(--scc-accent);
    font-size: 1.1rem;
    line-height: 1;
    cursor: pointer;
}
.scc-picker-btn:hover { background: var(--scc-border); color: var(--scc-heading); }

.scc-picker-modal { z-index: 10001; }
.scc-picker-modal.scc-picker-open { visibility: visible; opacity: 1; }
.scc-picker-modal .scc-modal-box { max-width: 480px; max-height: 80vh; }
.scc-picker-box .scc-modal-body { display: flex; flex-direction: column; min-height: 200px; }
.scc-state-picker-list {
    flex: 1;
    min-height: 240px;
    max-height: 360px;
    overflow-y: auto;
    margin-top: 0.5rem;
    border: 1px solid var(--scc-border);
    border-radius: 8px;
    background: var(--scc-bg);
}
.scc-picker-item {
    padding: 0.4rem 0.6rem;
    cursor: pointer;
    font-size: 0.9rem;
    font-family: ui-monospace, monospace;
    border-bottom: 1px solid var(--scc-border);
}
.scc-picker-item:last-child { border-bottom: none; }
.scc-picker-item:hover { background: var(--scc-border); }
.scc-picker-item:focus { outline: none; background: var(--scc-accent); color: #fff; }

/* Baumstruktur Picker */
.scc-picker-tree { padding: 0.25rem 0; }
.scc-picker-tree-row {
    display: flex;
    align-items: center;
    gap: 0.25rem;
    padding: 0.25rem 0.4rem;
    font-size: 0.88rem;
    font-family: ui-monospace, monospace;
    border-bottom: 1px solid rgba(255,255,255,0.06);
    min-height: 28px;
}
.scc-picker-tree-row:hover { background: rgba(255,255,255,0.06); }
.scc-picker-tree-row.scc-picker-folder { cursor: pointer; }
.scc-picker-tree-row.scc-picker-leaf { cursor: pointer; }
.scc-picker-tree-row.scc-picker-leaf:hover { background: rgba(33, 150, 243, 0.2); }
.scc-picker-toggle {
    width: 14px;
    text-align: center;
    font-size: 0.7rem;
    color: var(--scc-muted);
    flex-shrink: 0;
}
.scc-picker-icon {
    width: 16px;
    text-align: center;
    font-size: 0.75rem;
    color: var(--scc-muted);
    flex-shrink: 0;
}
.scc-picker-folder .scc-picker-icon { color: #9e9e9e; }
.scc-picker-leaf .scc-picker-icon { color: var(--scc-accent); }
.scc-picker-label { flex: 1; min-width: 0; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
.scc-picker-tree-children { margin-left: 0; }
.scc-state-picker-status { margin-top: 0.5rem; font-size: 0.85rem; }
